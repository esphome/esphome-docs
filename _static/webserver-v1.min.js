const source=new EventSource("/events");source.addEventListener("log",function(e){const t=document.getElementById("log");let n=[["[1;31m","e"],["[0;33m","w"],["[0;32m","i"],["[0;35m","c"],["[0;36m","d"],["[0;37m","v"]],o="";for(const t of n)e.data.startsWith(t[0])&&(o=t[1]);""==o&&(t.innerHTML+=e.data+"\n"),t.innerHTML+='<span class="'+o+'">'+e.data.substr(7,e.data.length-11)+"</span>\n"}),actions=[["switch",["toggle"]],["light",["toggle"]],["fan",["toggle"]],["cover",["open","close"]],["button",["press"]],["lock",["lock","unlock","open"]]],source.addEventListener("state",function(e){const t=JSON.parse(e.data);document.getElementById(t.id).children[1].innerText=t.state});const states=document.getElementById("states");let row,i=0;for(;row=states.rows[i];i++)if(row.children[2].children.length){for(const e of actions)if(row.classList.contains(e[0])){let t=row.id.substr(e[0].length+1);for(let n=0;n<row.children[2].children.length&&n<e[1].length;n++)row.children[2].children[n].addEventListener("click",function(){const o=new XMLHttpRequest;o.open("POST","/"+e[0]+"/"+t+"/"+e[1][n],!0),o.send()})}row.classList.contains("select")&&function(e){row.children[2].children[0].addEventListener("change",function(){const t=new XMLHttpRequest;t.open("POST","/select/"+e+"/set?option="+encodeURIComponent(this.value),!0),t.send()})}(row.id.substr(7))}