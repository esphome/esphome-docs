LD2410 Sensor
=============

.. seo::
    :description: Instructions for setting up LD2410 sensors.
    :image: ld2410.jpg

Component/Hub
-------------
.. _ld2410-component:

The ``ld2410`` sensor platform allows you to use HI-LINK LD2410 motion and presence sensor.
(`datasheet and user manual <https://drive.google.com/drive/folders/1p4dhbEJA3YubyIjIIC7wwVsSo8x29Fq-?spm=a2g0o.detail.1000023.17.93465697yFwVxH>`__) with ESPHome.
The :ref:`UART <uart>` is required to be set up in your configuration for this sensor to work.

.. figure:: ld2410.jpg
    :align: center
    :width: 80.0%

.. code-block:: yaml

    # Example configuration entry
    uart:
      id: uart1
      tx_pin: 18
      rx_pin: 23
      baud_rate: 256000 
      parity: NONE
      stop_bits: 1

    ld2410:
      no_one_duration: 150
      max_move_distance : 8
      max_still_distance: 1
      g0_move_sensitivity: 10
      g0_still_sensitivity: 20
      g1_move_sensitivity: 10
      g1_still_sensitivity: 20
      g2_move_sensitivity: 20
      g2_still_sensitivity: 21
      g3_move_sensitivity: 30
      g3_still_sensitivity: 31
      g4_move_sensitivity: 40
      g4_still_sensitivity: 41
      g5_move_sensitivity: 50
      g5_still_sensitivity: 51
      g6_move_sensitivity: 60
      g6_still_sensitivity: 61
      g7_move_sensitivity: 70
      g7_still_sensitivity: 71
      g8_move_sensitivity: 80
      g8_still_sensitivity: 81

    binary_sensor:
      - platform: ld2410
        has_target:
          name : "presence"
        has_moving_target:
          name : "movement"
        has_still_target:
          name: "still"

    sensor:
      - platform: ld2410
        moving_distance:
          name : "Moving distance (cm)"
        still_distance:
          name: "Still Distance (cm)"
        moving_energy:
          name: "Move Energy"
        still_energy:
          name: "Still Energy"
        detection_distance:
          name: "Distance Detection"


.. note::

    For UART configuration, ``baud_rate``, ``parity`` and ``stop_bits`` **must be** respectively ``256000``, ``NONE`` and ``1``
  
Configuration variables:
************************

The configuration is made up of three parts: The central component, individual sensors,
and binary sensors.

Base Configuration:

- **no_one_duration** (*Optional*, int): Time in seconds during which presence state will stay present after leaving. Defaults to ``5`` seconds.
- **max_move_distance** (*Optional*, int): Maximum distance for movement detection. Value between 0 and 8. Increment representing 0.75cm. Defaults to ``6`` (4.5 m).
- **max_still_distance** (*Optional*, int): Maximum distance for still detection. Value between 0 and 8. Increment representing 0.75cm. Defaults to ``6`` (4.5 m).
- **gX_move_sensitivity** (*Optional*, int): Sensitivity for the Xth gate for motion detection (X => 0 to 8). Above this level for the considered gate (distance), movement detection will be triggered. Defaults to ``see table below``.
- **gX _still_sensitivity** (*Optional*, int): Sensitivity for the Xth gate for still detection. (X => 0 to 8). Above this level for the considered gate (distance), still detection will be triggered. Defaults to ``see table below``.

.. list-table:: Default values for gate sensitivity
    :widths: 25 25 25
    :header-rows: 1

    * - Gate
      - Default Move sensitivity
      - Default Sitll Sensitivity
    * - 0
      - 50
      - 0
    * - 1
      - 50
      - 0
    * - 2
      - 40
      - 40
    * - 3
      - 40
      - 40
    * - 4
      - 40
      - 40
    * - 5
      - 40
      - 40
    * - 6
      - 30
      - 15
    * - 7
      - 30
      - 15
    * - 8
      - 30
      - 15

Sensor
------

The ``ld2410`` sensor allows you to use your :doc:`ld2410` to perform different
measurements.

Configuration variables:
************************
- **moving_distance** (*Optional*): Distance of detected moving target.

  - **name** (**Required**, string): The name for the sensor.
  - **id** (*Optional*, :ref:`config-id`): Set the ID of this sensor for use in lambdas.
  - All other options from :ref:`Sensor <config-sensor>`.

- **still_distance** (*Optional*): Distance of detected still target

  - **name** (**Required**, string): The name for the sensor.
  - **id** (*Optional*, :ref:`config-id`): Set the ID of this sensor for use in lambdas.
  - All other options from :ref:`Sensor <config-sensor>`.

- **moving_energy** (*Optional*): Energy for moving target

  - **name** (**Required**, string): The name for the sensor.
  - **id** (*Optional*, :ref:`config-id`): Set the ID of this sensor for use in lambdas.
  - All other options from :ref:`Sensor <config-sensor>`.

- **still_energy** (*Optional*): Energy for still target

  - **name** (**Required**, string): The name for the sensor.
  - **id** (*Optional*, :ref:`config-id`): Set the ID of this sensor for use in lambdas.
  - All other options from :ref:`Sensor <config-sensor>`.

- **detection_distance** (*Optional*): Distance in cm of target

  - **name** (**Required**, string): The name for the sensor.
  - **id** (*Optional*, :ref:`config-id`): Set the ID of this sensor for use in lambdas.
  - All other options from :ref:`Sensor <config-sensor>`.

Binary Sensor
-------------

The ``ld2410`` binary sensor allows you to use your :doc:`ld2410` to perform different
measurements.

Configuration variables:
************************

- **has_target** (*Optional*): If true target detect either still or in movement
- 
  - **name** (**Required**, string): The name for the binary sensor.
  - **id** (*Optional*, :ref:`config-id`): Set the ID of this sensor for use in lambdas.
  - All other options from :ref:`Binary Sensor <config-binary_sensor>`.

- **has_moving_target** (*Optional*): If true a moving target is detected.
- 
  - **name** (**Required**, string): The name for the binary sensor.
  - **id** (*Optional*, :ref:`config-id`): Set the ID of this sensor for use in lambdas.
  - All other options from :ref:`Binary Sensor <config-binary_sensor>`.

- **has_still_target** (*Optional*): If true a still target is detected.
- 
  - **name** (**Required**, string): The name for the binary sensor.
  - **id** (*Optional*, :ref:`config-id`): Set the ID of this sensor for use in lambdas.
  - All other options from :ref:`Binary Sensor <config-binary_sensor>`.


See Also
--------

- :ref:`Sensor <config-sensor>`
- `Datasheet and user manual <https://drive.google.com/drive/folders/1p4dhbEJA3YubyIjIIC7wwVsSo8x29Fq-?spm=a2g0o.detail.1000023.17.93465697yFwVxH>`__
- :apiref:`ld2410/ld2410.h`
- :ghedit:`Edit`
